/*
 * Trackiffer v0.1.2
 * Easy GA event tracking and debugging
 * https://github.com/averyvery/trackiffer
 *
 * Copyright 2011, Doug Avery
 * Dual licensed under the MIT and GPL licenses.
 * Uses the same license as jQuery, see:
 * http://jquery.org/license
 *
 * Edit the tracking rules to create simple click-based event trackers for GA events.
 * At any time, you can visit a page in your browser and paste this code into the console to test.
 * Add this script at the verrrry bottom of a site to start tracking.
 *
 * Compressed with http://jscompress.com/
 */

(function(a,b,c){function E(a,b,c){var d=z(b),e=function(c){var g=t(a.slice(0),b),h=A(b);_gaq.push(g);if(h){m("Delaying outbound action...");y(c,d,b,e)}else if(f){return false}};D(a,b,c);b.bind(d+".trackiffer",e)}function D(a,b,d){var e=function(){if(f){m(a);i[d].each(B)}},g=function(){if(f){i[d].each(C)}};if(typeof i[d]==="undefined"){i[d]=c()}i[d]=i[d].add(b);b.hover(e,g)}function C(){$(this).css({outline:"none"})}function B(){$(this).css({outline:"red 3px solid"})}function A(a){var b=false,c=a.attr("href")||a.attr("action")||"",d=location.host!==""||"localhost",b=c.indexOf(d)==-1&&c.match(/^http/i);return!!b}function z(a){var b="click";for(var c in j){if(a.is(c)){b=j[c]}}return b}function y(a,b,c){a.preventDefault();a.stopImmediatePropagation();var d=function(){x(b,c)};c.unbind(b+".trackiffer");setTimeout(d,1e3)}function x(a,c){m("Firing delayed "+a+"action!");if(f!==true){c.trigger(a);if(a==="click"&&c.hasClass("nofollow")===false){b.location=c[0].href}}}function w(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(typeof e==="function"){e=e(b)}else{var f=/#.+?#/,g=e.match(f),h,i;i=u(g,b);if(i){e=e.replace(f,i)}}e=v(e);a[c]=e}return a}function v(a){return a.charAt(0).toUpperCase()+a.slice(1)}function u(a,b){if(a){switch(a[0]){case"#VALUE#":replacement=b.val();break;case"#TEXT#":replacement=b.text();break;default:attribute=a[0].replace(/\#/g,"").toLowerCase();replacement=b.attr(attribute)}return replacement}}function t(a,b){a=w(a,b);m("TRACKING!",a);a.unshift("_trackEvent");return a}function s(a){if(h){for(selector in a){c(selector).each(function(){E(a[selector],$(this),selector)})}}else{m("Delaying bind until jQuery loads...");k=function(){s(a)}}}function r(b){m("Script not detected. Loading "+b);var c=a.createElement("script"),d=a.getElementsByTagName("script")[0];c.type="text/javascript";c.src=b;d.parentNode.insertBefore(c,d)}function q(){m("jQuery has loaded!");h=true;k()}function p(){o()?q():setTimeout(p,100)}function o(){e=b.jQuery&&c.fn.jquery||"0";m("Checking jQuery version: "+e);if(parseInt(e)>160){m("High enough! Executing")}var a=parseInt(e.split(".").join(""));return a>160}function n(){o()||r("http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js");p()}function m(){if(f){var a=Array.prototype.slice.call(arguments);a.unshift("---");console&&console.log&&console.log.apply(console,a)}}function l(){n()}function k(){}var d={},e="0.1.2",f=false,g="0",h=false,i={},j={form:"submit",select:"change","input[type=text]":"blur"};d.debug=function(){f=true;m("Trackiffer entering debug mode.");m("Tracked links WILL NOT WORK and WILL NOT TRACK while in debug mode.");_gat=undefined;_gaq=[["_setAccount","UA-11111111-1"]];r("http://www.google-analytics.com/u/ga_debug.js")};d.undebug=function(){f=false};d.version=function(){return e};b.trackiffer=function(a){typeof a==="object"?s(a):d[a]()};l()})(document,window,jQuery)
