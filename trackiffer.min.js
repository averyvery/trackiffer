/*
 * Trackiffer v0.1.3
 * Easy GA event tracking and debugging
 * https://github.com/averyvery/trackiffer
 *
 * Copyright 2011, Doug Avery
 * Dual licensed under the MIT and GPL licenses.
 * Uses the same license as jQuery, see:
 * http://jquery.org/license
 *
 * Edit the tracking rules to create simple click-based event trackers for GA events.
 * At any time, you can visit a page in your browser and paste this code into the console to test.
 * Add this script at the verrrry bottom of a site to start tracking.
 *
 * Compressed with http://jscompress.com/
 */

 (function(a,b){function F(a,b,c){var d=A(b),f=function(c){var g=u(a.slice(0),b),h=B(b);_gaq.push(g);if(h){n("Delaying outbound action...");z(c,d,b,f)}else if(e){return false}};E(a,b,c);b.bind(d+".trackiffer",f)}function E(a,b,c){var d=function(){e&&j[c].each(C)},g=function(){e&&j[c].each(D)};if(typeof j[c]==="undefined"){j[c]=jQuery()}j[c]=j[c].add(b);e&&b.css(f);b.hover(d,g)}function D(){$(this).css(f)}function C(){$(this).css(g)}function B(a){var b=false,c=a.attr("href")||a.attr("action")||"",d=location.host!==""||"localhost",b=c.indexOf(d)==-1&&c.match(/^http/i);return!!b}function A(a){var b="click";for(var c in k){if(a.is(c)){b=k[c]}}return b}function z(a,b,c){a.preventDefault();a.stopImmediatePropagation();var d=function(){y(b,c)};c.unbind(b+".trackiffer");setTimeout(d,100)}function y(a,c){n("Firing delayed "+a+"!");if(e!==true){c.trigger(a);if(a==="click"&&c.hasClass("nofollow")===false){b.location=c[0].href}}}function x(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(typeof e==="function"){e=e(b)}else{var f=/#.+?#/,g=e.match(f),h,i;i=v(g,b);if(i){e=e.replace(f,i)}}e=w(e);a[c]=e}return a}function w(a){return a.charAt(0).toUpperCase()+a.slice(1)}function v(a,b){if(a){switch(a[0]){case"#VALUE#":replacement=b.val();break;case"#TEXT#":replacement=b.text();break;default:attribute=a[0].replace(/\#/g,"").toLowerCase();replacement=b.attr(attribute)}return replacement}}function u(a,b){a=x(a,b);a.unshift("_trackEvent");return a}function t(a){if(i){for(selector in a){jQuery(selector).each(function(){F(a[selector],$(this),selector)})}}else{n("Delaying bind until jQuery loads...");l=function(){t(a)}}}function s(b){n("Script not detected. Loading "+b);var c=a.createElement("script"),d=a.getElementsByTagName("script")[0];c.type="text/javascript";c.src=b;d.parentNode.insertBefore(c,d)}function r(){n("jQuery has loaded!");i=true;l()}function q(){p()?r():setTimeout(q,100)}function p(){d=b.jQuery&&jQuery.fn.jquery||"0";n("Checking jQuery version: "+d);if(parseInt(d)>160){n("High enough! Executing")}var a=parseInt(d.split(".").join(""));return a>160}function o(){p()||s("http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js");q()}function n(){if(e){var a=Array.prototype.slice.call(arguments);a.unshift("---");console&&console.log&&console.log.apply(console,a)}}function m(){o()}function l(){}var c={},d="0.1.3",e=false,f={outline:"rgba(0,200,200,.35) 3px solid"},g={outline:"rgba(250,0,0,.7) 3px solid"},h="0",i=false,j={},k={form:"submit",select:"change","input[type=text]":"blur"};c.debug=function(){e=true;n("Trackiffer entering debug mode.");n("Tracked links WILL NOT WORK and WILL NOT TRACK while in debug mode.");_gat=undefined;_gaq=[["_setAccount","UA-00000000-1"]];s("http://www.google-analytics.com/u/ga_debug.js")};c.undebug=function(){e=false};c.version=function(){return d};b.trackiffer=function(a){typeof a==="object"?t(a):c[a]()};m()})(document,window)
