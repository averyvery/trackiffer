/*
 * Trackiffer v0.1.2
 * Easy GA event tracking and debugging
 * https://github.com/averyvery/trackiffer
 *
 * Copyright 2011, Doug Avery
 * Dual licensed under the MIT and GPL licenses.
 * Uses the same license as jQuery, see:
 * http://jquery.org/license
 *
 * Edit the tracking rules to create simple click-based event trackers for GA events.
 * At any time, you can visit a page in your browser and paste this code into the console to test.
 * Add this script at the verrrry bottom of a site to start tracking.
 *
 * Compressed with http://jscompress.com/
 */

(function(a,b){function D(a,b,c){var d=y(b),f=function(c){var g=s(a.slice(0),b),h=z(b);_gaq.push(g);if(h){l("Delaying outbound action...");x(c,d,b,f)}else if(e){return false}};C(a,b,c);b.bind(d+".trackiffer",f)}function C(a,b,c){var d=function(){if(e){l(a);h[c].each(A)}},f=function(){if(e){h[c].each(B)}};if(typeof h[c]==="undefined"){h[c]=jQuery()}h[c]=h[c].add(b);b.hover(d,f)}function B(){$(this).css({outline:"none"})}function A(){$(this).css({outline:"red 3px solid"})}function z(a){var b=false,c=a.attr("href")||a.attr("action")||"",d=location.host!==""||"localhost",b=c.indexOf(d)==-1&&c.match(/^http/i);return!!b}function y(a){var b="click";for(var c in i){if(a.is(c)){b=i[c]}}return b}function x(a,b,c){a.preventDefault();a.stopImmediatePropagation();var d=function(){w(b,c)};c.unbind(b+".trackiffer");setTimeout(d,100)}function w(a,c){l("Firing delayed "+a+"!");if(e!==true){c.trigger(a);if(a==="click"&&c.hasClass("nofollow")===false){b.location=c[0].href}}}function v(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(typeof e==="function"){e=e(b)}else{var f=/#.+?#/,g=e.match(f),h,i;i=t(g,b);if(i){e=e.replace(f,i)}}e=u(e);a[c]=e}return a}function u(a){return a.charAt(0).toUpperCase()+a.slice(1)}function t(a,b){if(a){switch(a[0]){case"#VALUE#":replacement=b.val();break;case"#TEXT#":replacement=b.text();break;default:attribute=a[0].replace(/\#/g,"").toLowerCase();replacement=b.attr(attribute)}return replacement}}function s(a,b){a=v(a,b);l("TRACKING!",a);a.unshift("_trackEvent");return a}function r(a){if(g){for(selector in a){jQuery(selector).each(function(){D(a[selector],$(this),selector)})}}else{l("Delaying bind until jQuery loads...");j=function(){r(a)}}}function q(b){l("Script not detected. Loading "+b);var c=a.createElement("script"),d=a.getElementsByTagName("script")[0];c.type="text/javascript";c.src=b;d.parentNode.insertBefore(c,d)}function p(){l("jQuery has loaded!");g=true;j()}function o(){n()?p():setTimeout(o,100)}function n(){d=b.jQuery&&jQuery.fn.jquery||"0";l("Checking jQuery version: "+d);if(parseInt(d)>160){l("High enough! Executing")}var a=parseInt(d.split(".").join(""));return a>160}function m(){n()||q("http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js");o()}function l(){if(e){var a=Array.prototype.slice.call(arguments);a.unshift("---");console&&console.log&&console.log.apply(console,a)}}function k(){m()}function j(){}var c={},d="0.1.2",e=false,f="0",g=false,h={},i={form:"submit",select:"change","input[type=text]":"blur"};c.debug=function(){e=true;l("Trackiffer entering debug mode.");l("Tracked links WILL NOT WORK and WILL NOT TRACK while in debug mode.");_gat=undefined;_gaq=[["_setAccount","UA-11111111-1"]];q("http://www.google-analytics.com/u/ga_debug.js")};c.undebug=function(){e=false};c.version=function(){return d};b.trackiffer=function(a){typeof a==="object"?r(a):c[a]()};k()})(document,window)
