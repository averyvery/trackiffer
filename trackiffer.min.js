/*
 * Trackiffer v0.1.2
 * Easy GA event tracking and debugging
 * https://github.com/averyvery/trackiffer
 *
 * Copyright 2011, Doug Avery
 * Dual licensed under the MIT and GPL licenses.
 * Uses the same license as jQuery, see:
 * http://jquery.org/license
 *
 * Edit the tracking rules to create simple click-based event trackers for GA events.
 * At any time, you can visit a page in your browser and paste this code into the console to test.
 * Add this script at the verrrry bottom of a site to start tracking.
 *
 * Compressed with http://jscompress.com/
 */

 (function(){function B(a,b,d){var e=w(b),f=function(d){var g=q(a.slice(0),b),h=x(b);_gaq.push(g);if(h){j("Delaying outbound action...");v(d,e,b,f)}else if(c){return false}};A(a,b,d);b.bind(e+".trackiffer",f)}function A(a,b,d){var e=function(){if(c){j(a);f[d].each(y)}},g=function(){if(c){f[d].each(z)}};if(typeof f[d]==="undefined"){f[d]=jQuery()}f[d]=f[d].add(b);b.hover(e,g)}function z(){$(this).css({outline:"none"})}function y(){$(this).css({outline:"red 3px solid"})}function x(a){var b=false,c=a.attr("href")||a.attr("action")||"",d=location.host!==""||"localhost",b=c.indexOf(d)==-1&&c.match(/^http/i);return!!b}function w(a){var b="click";for(var c in g){if(a.is(c)){b=g[c]}}return b}function v(a,b,c){a.preventDefault();a.stopImmediatePropagation();var d=function(){u(b,c)};c.unbind(b+".trackiffer");setTimeout(d,1e3)}function u(a,b){j("Firing delayed "+a+"action!");if(c!==true){b.trigger(a);if(a==="click"&&b.hasClass("nofollow")===false){window.location=b[0].href}}}function t(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(typeof e==="function"){e=e(b)}else{var f=/#.+?#/,g=e.match(f),h,i;i=r(g,b);if(i){e=e.replace(f,i)}}e=s(e);a[c]=e}return a}function s(a){return a.charAt(0).toUpperCase()+a.slice(1)}function r(a,b){if(a){switch(a[0]){case"#VALUE#":replacement=b.val();break;case"#TEXT#":replacement=b.text();break;default:attribute=a[0].replace(/\#/g,"").toLowerCase();replacement=b.attr(attribute)}return replacement}}function q(a,b){a=t(a,b);j("TRACKING!",a);a.unshift("_trackEvent");return a}function p(a){if(e){for(selector in a){jQuery(selector).each(function(){B(a[selector],$(this),selector)})}}else{j("Delaying bind until jQuery loads...");h=function(){p(a)}}}function o(a){j("Script not detected. Loading "+a);var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];b.type="text/javascript";b.src=a;c.parentNode.insertBefore(b,c)}function n(){j("jQuery has loaded!");e=true;h()}function m(){l()?n():setTimeout(m,100)}function l(){b=window.jQuery&&jQuery.fn.jquery||"0";j("Checking jQuery version: "+b);if(parseInt(b)>160){j("High enough! Executing")}var a=parseInt(b.split(".").join(""));return a>160}function k(){l()||o("http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js");m()}function j(){if(c){var a=Array.prototype.slice.call(arguments);a.unshift("---");console&&console.log&&console.log.apply(console,a)}}function i(){k()}function h(){}var a={},b="0.1.2",c=false,d="0",e=false,f={},g={form:"submit",select:"change","input[type=text]":"blur"};a.debug=function(){c=true;j("Trackiffer entering debug mode.");j("Tracked links WILL NOT WORK and WILL NOT TRACK while in debug mode.");_gat=undefined;_gaq=[["_setAccount","UA-11111111-1"]];o("http://www.google-analytics.com/u/ga_debug.js")};a.undebug=function(){c=false};a.version=function(){return b};window.trackiffer=function(b){typeof b==="object"?p(b):a[b]()};i()})()
